{% extends 'base.html' %}
{% load static %}


{% block titulo %}
    Psicosfera | Psicologo
{% endblock %}


{% block btns %}
<li><a href="{% url 'interfaz' %}#directorio" >Directorio</a></li>
<li><a href="{% url 'interfaz' %}#agenda" >Agenda</a></li>
<li><a href="{% url 'interfaz' %}#diario" >Diario</a></li>
{% endblock %}

{% block contenido %}
<section id="directorio" class="service-details">
  <div class="container">
    <div class="container section-title" data-aos="fade-up">
      <h2>Directorio de Pacientes</h2>
    </div><!-- End Section Title -->
    <div class="row gy-5">
      <div class="col-lg-4" data-aos="fade-up" data-aos-delay="100">
        <div class="service-box">
          <div class="container section-title" data-aos="fade-up">
            <h2>Pacientes</h2>
          </div><!-- End Section Title -->
          <div id="myCarousel" class="carousel slide" >
            <div class="carousel-inner">
              <div class="carousel-item active">
                <div class="services-list">
                  {% for paciente in pacientes %}
                  {% if paciente.nombre == paciente_seleccionado.nombre %}
                  <a href="{% url 'datos_paciente' paciente.id %}" id="" onclick="changeClass(this)" class="btn active" data-paciente-id="{{ paciente.id }}"><i class="bi bi-arrow-right-circle"></i><span>{{ paciente.nombre }}</span></a>
                  {% else %}
                        <a href="{% url 'datos_paciente' paciente.id %}" id="" onclick="changeClass(this)" class="btn" data-paciente-id="{{ paciente.id }}"><i class="bi bi-arrow-right-circle"></i><span>{{ paciente.nombre }}</span></a>
                      {% endif %}
                    {% endfor %} 
                  </div>
                </div>
              </div>
              <button class="carousel-control-prev" type="button" data-bs-target="#myCarousel" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#myCarousel" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
              </button>
            </div>     
          </div><!-- End Services List -->
          <div class="service-box">
            <h4>Descargar detalles</h4>
            <div class="download-catalog">
              <a href="#"><i class="bi bi-filetype-pdf"></i><span>Catalog PDF</span></a>
              <a href="#"><i class="bi bi-file-earmark-word"></i><span>Catalog DOC</span></a>
            </div>
          </div><!-- End Services List -->
        </div>
        {% if paciente_seleccionado %}
        <div class="col-lg-8 ps-lg-5" data-aos="fade-up" data-aos-delay="200">
          <div id="datos-paciente" class="service-box">
            
            <h2>{{ paciente_seleccionado.nombre }} {{ paciente_seleccionado.apaterno }} {{ paciente_seleccionado.amaterno }} </h2>
            <p>Correo Electronico: {{ paciente_seleccionado.correo }}</p>
            <p>Telefono: {{ paciente_seleccionado.telefono }}</p>
            <p>Direccion: {{ paciente_seleccionado.direccion }}</p>
            <!-- Agrega otros campos que desees mostrar -->
            
            <p>Edad: {{ paciente_seleccionado.edad }}</p>
            <p>Sexo: {{ paciente_seleccionado.Sexo }}</p>
            <p>Ocupacion: {{ paciente_seleccionado.Ocupacion }}</p>
            <p>Fecha de nacimiento: {{ paciente_seleccionado.fecha_nacimiento }}</p>
            <!-- Agrega otros campos que desees mostrar -->
            {% if expediente %}
            <div class="container">
              <div class="swiper ">
                <template class="swiper-config">
                  {
                    "speed" : 600,
                    "slidesPerView": "auto",
                    "pagination": {
                  "el": ".swiper-pagination",
                  "type": "bullets",
                  "clickable": true
                }
              }
            </template>
            <div class="swiper-wrapper">
              <div class="swiper-slide">
                <div class="testimonial-item">
                  <div class="d-flex">
                    <div>
                      <h5>Notas Personales</h5>
                    </div>
                  </div>
                  <form action="{% url 'guardar_notas_personales' paciente_seleccionado.id %}" data-aos="fade-up" data-aos-delay="300" method="post">
                    {% csrf_token %}
                    <textarea name="notas-personales" class="form-control" id="" cols="30" rows="10" >
Observaciones:
{{ expediente.observaciones }}

                    </textarea>
                    <input type="submit" class="btn btn-primary" value="Guardar nota"></input>
                  </form>
                </div>
              </div><!-- End testimonial item -->
              <div class="swiper-slide">
                <div class="testimonial-item">
                  <div class="d-flex">
                    <div>
                      <h5>Notas Compartidas</h5>
                    </div>
                  </div>
                  <form action="{% url 'guardar_notas_compartidas' paciente_seleccionado.id %}" data-aos="fade-up" data-aos-delay="300" method="post">
                    {% csrf_token %}
                    <textarea name="notas-personales" class="form-control" id="" cols="30" rows="10" >
Diagnostico:
{{ expediente.diagnostico }}

                    </textarea>
                    <input type="submit" class="btn btn-primary" value="Guardar nota"></input>
                  </form>
                </div>
              </div><!-- End testimonial item -->
            </div>
            <br>
            <div class="swiper-pagination"></div>
            {% endif %}
          </div>
        </div>
        {% endif %} 
      </div>
    </div>
</section>
        
<section id="agenda" class="service-details">
  <div class="container">  
    <div class="container section-title" data-aos="fade-up">
      <h2>Calendario de citas</h2>
    </div><!-- End Section Title -->
    <div id='calendar'></div>
  </div>
</section>
{% endblock %}


{% block scripts %}
  <script src="{% static 'fullcalendar/dist/index.global.min.js' %}" ></script>
  <script>
      document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay'
      },
      initialDate: '2023-01-12',
      navLinks: true, // can click day/week names to navigate views
      selectable: true,
      selectMirror: true,
      select: function(arg) {
        var title = prompt('Event Title:');
        if (title) {
          calendar.addEvent({
            title: title,
            start: arg.start,
            end: arg.end,
            allDay: arg.allDay
          })
        }
        calendar.unselect()
      },
      eventClick: function(arg) {
        if (confirm('Are you sure you want to delete this event?')) {
          arg.event.remove()
        }
      },
      editable: true,
      dayMaxEvents: true, // allow "more" link when too many events
      events: [
        {
          title: 'All Day Event',
          start: '2023-01-01'
        },
        {
          title: 'Long Event',
          start: '2023-01-07',
          end: '2023-01-10'
        },
        {
          groupId: 999,
          title: 'Repeating Event',
          start: '2023-01-09T16:00:00'
        },
        {
          groupId: 999,
          title: 'Repeating Event',
          start: '2023-01-16T16:00:00'
        },
        {
          title: 'Conference',
          start: '2023-01-11',
          end: '2023-01-13'
        },
        {
          title: 'Meeting',
          start: '2023-01-12T10:30:00',
          end: '2023-01-12T12:30:00'
        },
        {
          title: 'Lunch',
          start: '2023-01-12T12:00:00'
        },
        {
          title: 'Meeting',
          start: '2023-01-12T14:30:00'
        },
        {
          title: 'Happy Hour',
          start: '2023-01-12T17:30:00'
        },
        {
          title: 'Dinner',
          start: '2023-01-12T20:00:00'
        },
        {
          title: 'Birthday Party',
          start: '2023-01-13T07:00:00'
        },
        {
          title: 'Click for Google',
          url: 'http://google.com/',
          start: '2023-01-28'
        }
      ]
    });

    calendar.render();
  });
  
  </script>
  <script src="{% static 'js/jquery-3.3.1.min.js' %}"></script>
  <!--

  <script>
    function changeClass(boton) { 
      var botones = document.querySelectorAll('.btn');
      botones.forEach(function(botone) {
        botone.classList.remove('active');
      });
      boton.classList.add('active'); 
      
    }
  </script>
  -->
{% endblock %}
    
    
    